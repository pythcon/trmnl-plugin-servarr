{% comment %}
  Half Horizontal Layout (800x240)
  Servarr Dashboard - Two-column horizontal view
  Left: Queue | Right: Stats + Recently Added/Upcoming
  Supports: Sonarr, Radarr, Lidarr, Readarr, Prowlarr
{% endcomment %}

{% assign show_queue = trmnl.plugin_settings.custom_fields_values.show_queue | default: "yes" %}
{% assign show_calendar = trmnl.plugin_settings.custom_fields_values.show_calendar | default: "yes" %}
{% assign show_recently_added = trmnl.plugin_settings.custom_fields_values.show_recently_added | default: "yes" %}
{% assign show_stats = trmnl.plugin_settings.custom_fields_values.show_stats | default: "yes" %}
{% assign show_quality = trmnl.plugin_settings.custom_fields_values.show_quality | default: "yes" %}
{% assign show_eta = trmnl.plugin_settings.custom_fields_values.show_eta | default: "yes" %}
{% assign show_network = trmnl.plugin_settings.custom_fields_values.show_network | default: "yes" %}
{% assign date_format = trmnl.plugin_settings.custom_fields_values.date_format | default: "relative" %}
{% assign max_queue_items = trmnl.plugin_settings.custom_fields_values.max_queue_items | default: 3 %}
{% assign max_calendar_items = trmnl.plugin_settings.custom_fields_values.max_calendar_items | default: 3 %}
{% assign max_recently_added_items = trmnl.plugin_settings.custom_fields_values.max_recently_added_items | default: 3 %}

{%- capture icon_tv -%}<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="7" width="20" height="15" rx="2" ry="2"/><polyline points="17 2 12 7 7 2"/></svg>{%- endcapture -%}
{%- capture icon_film -%}<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"/><line x1="7" y1="2" x2="7" y2="22"/><line x1="17" y1="2" x2="17" y2="22"/><line x1="2" y1="12" x2="22" y2="12"/></svg>{%- endcapture -%}
{%- capture icon_hdd -%}<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="12" x2="2" y2="12"/><path d="M5.45 5.11L2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"/></svg>{%- endcapture -%}
{%- capture icon_search -%}<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>{%- endcapture -%}
{%- capture icon_user -%}<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>{%- endcapture -%}
{%- capture icon_disc -%}<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="3"/></svg>{%- endcapture -%}
{%- capture icon_book -%}<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>{%- endcapture -%}
{%- capture icon_list -%}<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/></svg>{%- endcapture -%}
{%- capture icon_download -%}<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>{%- endcapture -%}

{% comment %} App Logos (from homarr-labs/dashboard-icons) {% endcomment %}
{%- capture logo_sonarr -%}<svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 512 512"><path d="M511.8 256c0 70.4-24.9 130.8-74.6 181.1-1.7 2-3.5 3.8-5.5 5.4-8.2 8-16.8 15.3-26 21.8Q341.05 512 256.3 512c-56.6 0-106.3-15.9-149.2-47.7-11.3-8-22-17.1-31.9-27.3C36.5 398.7 12.8 354 4 303.2c-1.7-9.9-2.9-20-3.4-30.2-.2-5.7-.4-11.3-.4-17 0-6 .1-11.7.4-17.1 0-.6.2-1.1.5-1.7 3.7-62.8 28.4-117 74.1-162.8C125.5 24.8 185.8 0 256.2 0c70.7 0 131 24.8 180.9 74.5q74.7 75.9 74.7 181.5" fill="#eee"/><path d="m459.7 100.3-52.9 52.9c-30.9 30.9-33.6 57.8-33.6 105.3 0 42.3 6.7 81.1 38.2 112.6 23 23 44.9 44.7 44.9 44.7-5.9 7.2-12.3 14.3-19.1 21.2-1.7 2-3.5 3.8-5.5 5.4-6 5.9-12.2 11.4-18.6 16.4l-41.4-41.4C334.9 380.6 305.6 377 257 377c-46.7 0-78.4 4.3-112.6 38.5-20.4 20.4-43.8 43.9-43.8 43.9-8.9-6.8-17.3-14.2-25.3-22.4-6.6-6.6-12.8-13.4-18.5-20.3 0 0 23.1-23.2 45.2-45.3 32.7-32.7 38-70.6 38-113 0-41.3-6.8-79.8-36.8-109.9C82.2 127.7 53.3 99 53.3 99c6.7-8.5 14-16.7 21.8-24.5 6.9-6.8 14-13.1 21.2-19l48 48c30.7 30.7 70 38.6 112.4 38.6 43.6 0 82.8-8.4 114.7-40.4C391 82.1 417 56.3 417 56.3c6.8 5.6 13.5 11.6 20.1 18.2 8.3 8.3 15.8 16.9 22.6 25.8" fill="#3a3f51"/><path d="M186 269.1c-.5-2.8-.8-5.5-.9-8.4-.1-1.6-.1-3.1-.1-4.7 0-1.7 0-3.2.1-4.7 0-.2 0-.3.1-.5 1-17.4 7.9-32.4 20.5-45.1 13.9-13.8 30.6-20.7 50.2-20.7s36.3 6.9 50.2 20.7c13.8 14 20.7 30.8 20.7 50.3s-6.9 36.2-20.7 50.2c-.5.5-1 1.1-1.5 1.5q-3.45 3.3-7.2 6-18 13.2-41.4 13.2c-23.4 0-29.4-4.4-41.3-13.2-3.1-2.2-6.1-4.7-8.9-7.6-10.8-10.6-17.3-22.9-19.8-37" fill="#0cf"/><path d="m372.7 141-35.4 34.6M72.9 76.8l96.5 96.1m199.7 198.9 65.6 67.9m4.4-363.3L372.7 141M76.6 438.5l64.6-64.7" fill="none" stroke="#0cf" stroke-width="2"/><path d="m372.7 141-40 40.6m-193.3-38.5 40.6 40.5M141 374l39.5-41.1m146.2-3.3 42.6 42.4" fill="none" stroke="#0cf" stroke-width="7"/></svg>{%- endcapture -%}
{%- capture logo_radarr -%}<svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 512 512"><g transform="translate(70 21)"><path d="m10.3 59.8 3.9 372.4c-31.4 3.9-54.9-11.8-54.9-43.1l-3.9-309.7c0-98 90.2-121.5 145.1-82.3l278.3 160.7c39.2 27.4 47 78.4 27.4 113.7-3.9-27.4-15.7-43.1-39.2-58.8L53.4 36.2C29.9 20.6 10.3 24.5 10.3 59.8" fill="#24292e"/><path d="M-13.2 451.8c23.5 7.8 47 3.9 66.6-7.8l321.5-188.2c19.6 27.4 15.7 54.9-7.8 70.6L96.5 483.2c-39.2 19.6-90.1 0-109.7-31.4" fill="#24292e"/><path d="M80.9 342 273 232.3 84.8 126.4z" fill="#ffc230"/></g></svg>{%- endcapture -%}
{%- capture logo_lidarr -%}<svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 512 512"><circle cx="256" cy="256" r="256" fill="#1fda9a"/><circle cx="256" cy="256" r="200" fill="#19b87f"/><path d="M180 180v152l152-76z" fill="#fff"/></svg>{%- endcapture -%}
{%- capture logo_readarr -%}<svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 512 512"><circle cx="256" cy="256" r="256" fill="#eee" stroke="#443c3c" stroke-width="1.5"/><circle cx="256" cy="256" r="220.9" fill="#443c3c"/><circle cx="256" cy="256" r="194.3" fill="#8e2222"/><circle cx="256" cy="256" r="189.7" fill="#eee" stroke="#8e2222" stroke-width="1.5"/><circle cx="255.3" cy="256.7" r="133" fill="#443c3c"/><path d="M87.2 341s-2.5-178.7-2.9-179c.3-26.7 8.8-24 15.3-24.8 99.7 5.4 136 35.8 138.2 36.9 6.7 2.5 10.5 16 10.2 15.6.3.3 2.2 211.1 1.9 210.8 1.6 11.3-6.7 10.5-7 10.2-62.7-49.3-149.4-61.7-149.7-62-6-.5-6-7.7-6-7.7z" fill="#eee" stroke="#8e2222" stroke-width="10"/><path d="M423.5 341.4s2.5-179.1 2.9-179.5c-.3-26.7-8.8-24.1-15.3-24.9-99.7 5.4-136 35.9-138.2 37-6.7 2.5-10.5 16-10.2 15.7-.3.3-2.2 211.6-1.9 211.3-1.6 11.3 6.7 10.6 7 10.2 62.7-49.4 149.4-61.8 149.7-62.2 6-.3 6-7.6 6-7.6z" fill="#eee" stroke="#8e2222" stroke-width="10"/><path d="M85.9 369.7S83.3 191 83 190.7c.3-26.7 8.9-24 15.5-24.8 101.3 5.4 138.2 35.8 140.4 36.9 6.8 2.5 10.7 16 10.4 15.6.3.3 2.3 211.1 1.9 210.8 1.6 11.3-6.8 10.5-7.1 10.2-63.8-49.3-151.8-61.7-152.1-62-6.1-.4-6.1-7.7-6.1-7.7z" fill="#8e2222" stroke="#8e2222" stroke-width="5"/><path d="M424.8 370s2.6-179.1 2.9-179.5c-.3-26.7-8.9-24.1-15.5-24.9-101.3 5.4-138.2 35.9-140.5 37-6.8 2.5-10.7 16-10.4 15.7-.3.3-2.3 211.6-1.9 211.3-1.6 11.3 6.8 10.6 7.1 10.2 63.8-49.4 151.8-61.8 152.1-62.2 6.2-.3 6.2-7.6 6.2-7.6z" fill="#8e2222" stroke="#8e2222" stroke-width="5"/></svg>{%- endcapture -%}
{%- capture logo_prowlarr -%}<svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 512 512"><circle cx="256" cy="256" r="245" fill="#ffe6d5"/><path d="m132 314 8 10 61 .2-8-10z" fill="#83331b"/><path d="M132 314v-26c5-.2 8-2 8-4h47c-.4.5-.6 1.1-.6 1.7 0 2.2 2.7 4 6.2 4.2v24z" fill="#f8a37b"/><path d="M167 310c1 .5 3 2 2 4l-.5.6h4c-.5-1.2-2.4-2.6-2.4-2.6s-.2-.3-1-1c-.6-.3-1.3-.6-1.8-.7m-12 0c-.5.2-1.2.6-1.7 1.2-.9.9-1 2.1-1 2.1l-.6 1h2.4c-.2-.1-.3-.3-.5-.6-.9-1.6.5-3.1 1.4-3.7m11 0c-.5.1-1.5.2-2.5.5-1.5.5-2.3 1.6-2.3 1.6s-1.6-1-3.8-1.4c-.7-.1-1.2-.2-1.5-.2 0 .7-.2 1.5-.2 1.5s-.4 1.3-1 1.7h13c-.6-.4-1-1.7-1-1.7s-.3-1.1-.3-2" fill="#da845d"/><circle cx="256" cy="256" r="245" fill="none" stroke="#e66001" stroke-width="22"/><path d="M140 336s7 9 22 7c15-2 20-21 20-21l-6-8h-36z" fill="#ef5d22"/><path d="m118 314-2 3s8 16 18 19c11 4 19-2 24-6s8-14 8-14l-2-2z" fill="#f46a2f"/><path d="m116 316 7 2s-2 7 4 10 9 0 10-2 1-7 1-7h8s0 8 3 10 8 3 10-2 0-8 0-8l9-4-2-2h-46z" fill="#fff"/><path d="M147 323c0-2-1-3-3-3s-3 1-3 3 1 3 3 3 3-1 3-3" fill="#fddd04"/><path d="M148 323c0-1-1-2-2-2s-2 1-2 2 1 2 2 2 2-1 2-2" fill="#391913"/><path d="M164 323c0-2-1-3-3-3s-3 1-3 3 1 3 3 3 3-1 3-3" fill="#fddd04"/><path d="M163 323c0-1-1-2-2-2s-2 1-2 2 1 2 2 2 2-1 2-2" fill="#391913"/><path d="M380 314v-26c-5-.2-8-2-8-4h-47c.4.5.6 1.1.6 1.7 0 2.2-2.7 4-6.2 4.2v24z" fill="#f8a37b"/><path d="M380 314l-8 10-61 .2 8-10z" fill="#83331b"/><path d="M345 310c-1 .5-3 2-2 4l.5.6h-4c.5-1.2 2.4-2.6 2.4-2.6s.2-.3 1-1c.6-.3 1.3-.6 1.8-.7m12 0c.5.2 1.2.6 1.7 1.2.9.9 1 2.1 1 2.1l.6 1h-2.4c.2-.1.3-.3.5-.6.9-1.6-.5-3.1-1.4-3.7m-11 0c.5.1 1.5.2 2.5.5 1.5.5 2.3 1.6 2.3 1.6s1.6-1 3.8-1.4c.7-.1 1.2-.2 1.5-.2 0 .7.2 1.5.2 1.5s.4 1.3 1 1.7h-13c.6-.4 1-1.7 1-1.7s.3-1.1.3-2" fill="#da845d"/><path d="M372 336s-7 9-22 7c-15-2-20-21-20-21l6-8h36z" fill="#ef5d22"/><path d="m394 314 2 3s-8 16-18 19c-11 4-19-2-24-6s-8-14-8-14l2-2z" fill="#f46a2f"/><path d="m396 316-7 2s2 7-4 10-9 0-10-2-1-7-1-7h-8s0 8-3 10-8 3-10-2 0-8 0-8l-9-4 2-2h46z" fill="#fff"/><path d="M365 323c0-2 1-3 3-3s3 1 3 3-1 3-3 3-3-1-3-3" fill="#fddd04"/><path d="M364 323c0-1 1-2 2-2s2 1 2 2-1 2-2 2-2-1-2-2" fill="#391913"/><path d="M348 323c0-2 1-3 3-3s3 1 3 3-1 3-3 3-3-1-3-3" fill="#fddd04"/><path d="M349 323c0-1 1-2 2-2s2 1 2 2-1 2-2 2-2-1-2-2" fill="#391913"/></svg>{%- endcapture -%}

<style>
  /* ===== APP LOGO ===== */
  .app-logo {
    display: inline-flex;
    align-items: center;
    margin-right: 6px;
    vertical-align: middle;
  }
  .app-logo svg {
    height: 20px;
    width: auto;
  }
  .servarr-half-h {
    display: flex;
    flex-direction: row;
    gap: 10px;
    padding: 10px;
    height: 190px;
    box-sizing: border-box;
  }
  .servarr-col {
    display: flex;
    flex-direction: column;
    gap: 6px;
    overflow: hidden;
  }
  .servarr-col--queue {
    width: 260px;
    flex-shrink: 0;
  }
  .servarr-col--right {
    flex: 1;
    min-width: 0;
  }
  .servarr-card {
    background: white;
    border: 2px solid black;
    border-radius: 6px;
    padding: 8px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    overflow: hidden;
    height: 100%;
  }
  .servarr-card--row {
    flex-direction: row;
    gap: 8px;
    align-items: stretch;
  }
  .servarr-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-bottom: 4px;
    border-bottom: 1px dashed #ccc;
  }
  .servarr-header-title {
    font-family: 'DepartureMono', monospace;
    font-size: 13px;
    font-weight: bold;
  }
  .servarr-badge {
    font-family: 'DepartureMono', monospace;
    font-size: 10px;
    background: #e5e5e5;
    padding: 1px 5px;
    border-radius: 3px;
  }
  .servarr-content {
    display: flex;
    flex-direction: column;
    gap: 4px;
    flex: 1;
    justify-content: flex-start;
  }
  .servarr-item {
    display: flex;
    flex-direction: column;
    gap: 1px;
  }
  .servarr-item-title {
    font-family: 'DepartureMono', monospace;
    font-size: 11px;
    font-weight: bold;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .servarr-item-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-family: 'DepartureMono', monospace;
    font-size: 9px;
    color: #333;
  }
  .servarr-progress {
    width: 100%;
    height: 3px;
    background: #e5e5e5;
    border-radius: 2px;
  }
  .servarr-progress-bar {
    height: 100%;
    background: black;
    border-radius: 2px;
  }
  .servarr-stats-row {
    display: flex;
    flex-direction: row;
    gap: 6px;
    flex: 1;
  }
  .servarr-stat-box {
    border: 1px solid black;
    border-radius: 4px;
    padding: 4px 6px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 1px;
    flex: 1;
  }
  .servarr-stat-icon {
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .servarr-stat-value {
    font-family: 'DepartureMono', monospace;
    font-size: 14px;
    font-weight: bold;
    line-height: 1;
  }
  .servarr-stat-label {
    font-family: 'DepartureMono', monospace;
    font-size: 8px;
    color: #333;
  }
  .servarr-list-section {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: 4px;
    border-left: 1px solid #ddd;
    padding-left: 8px;
  }
  .servarr-list-header {
    font-family: 'DepartureMono', monospace;
    font-size: 11px;
    font-weight: bold;
    color: #333;
  }
  .servarr-empty {
    font-family: 'DepartureMono', monospace;
    font-size: 10px;
    color: #666;
    text-align: center;
    padding: 8px 0;
  }
</style>

<div class="servarr-half-h">

  <!-- Queue Column (Left) -->
  {% if show_queue == "yes" %}
  <div class="servarr-col servarr-col--queue">
    <div class="servarr-card">
      <div class="servarr-header">
        <span class="servarr-header-title">Queue</span>
        <span class="servarr-badge">{{ queue.count | default: 0 }}</span>
      </div>
      <div class="servarr-content">
        {% if queue.items and queue.items.size > 0 %}
          {% for item in queue.items limit: max_queue_items %}
            <div class="servarr-item">
              <div class="servarr-item-title">{{ item.title | truncate: 28 }}</div>
              <div class="servarr-item-meta">
                {% if show_quality == "yes" %}<span>{{ item.quality }}</span>{% endif %}
                {% if show_eta == "yes" %}<span>{{ item.eta }}</span>{% endif %}
              </div>
              <div class="servarr-progress">
                <div class="servarr-progress-bar" style="width: {{ item.progress | default: 0 }}%;"></div>
              </div>
            </div>
          {% endfor %}
          {% assign remaining = queue.count | minus: max_queue_items %}
          {% if remaining > 0 %}
            <div class="servarr-empty">+{{ remaining }} more</div>
          {% endif %}
        {% else %}
          <div class="servarr-empty">Queue empty</div>
        {% endif %}
      </div>
    </div>
  </div>
  {% endif %}

  <!-- Right Column: Stats + Recently Added/Upcoming -->
  <div class="servarr-col servarr-col--right">
    <div class="servarr-card servarr-card--row">

      <!-- Stats Section (4-column horizontal) -->
      {% if show_stats == "yes" %}
      <div class="servarr-stats-row">
        {% case app_type %}
          {% when "sonarr" %}
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_tv }}</span>
              <span class="servarr-stat-value">{{ stats.total_series | default: "0" }}</span>
              <span class="servarr-stat-label">Series</span>
            </div>
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_film }}</span>
              <span class="servarr-stat-value">{{ stats.total_episodes | default: "0" }}</span>
              <span class="servarr-stat-label">Episodes</span>
            </div>
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_hdd }}</span>
              <span class="servarr-stat-value">{{ stats.episodes_on_disk | default: "0" }}</span>
              <span class="servarr-stat-label">On Disk</span>
            </div>
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_search }}</span>
              <span class="servarr-stat-value">{{ stats.monitored_missing | default: "0" }}</span>
              <span class="servarr-stat-label">Wanted</span>
            </div>
          {% when "radarr" %}
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_film }}</span>
              <span class="servarr-stat-value">{{ stats.total_movies | default: "0" }}</span>
              <span class="servarr-stat-label">Movies</span>
            </div>
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_hdd }}</span>
              <span class="servarr-stat-value">{{ stats.movies_on_disk | default: "0" }}</span>
              <span class="servarr-stat-label">On Disk</span>
            </div>
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_search }}</span>
              <span class="servarr-stat-value">{{ stats.movies_missing | default: "0" }}</span>
              <span class="servarr-stat-label">Missing</span>
            </div>
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_download }}</span>
              <span class="servarr-stat-value">{{ queue.count | default: "0" }}</span>
              <span class="servarr-stat-label">Queue</span>
            </div>
          {% when "lidarr" %}
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_user }}</span>
              <span class="servarr-stat-value">{{ stats.total_artists | default: "0" }}</span>
              <span class="servarr-stat-label">Artists</span>
            </div>
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_disc }}</span>
              <span class="servarr-stat-value">{{ stats.total_albums | default: "0" }}</span>
              <span class="servarr-stat-label">Albums</span>
            </div>
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_hdd }}</span>
              <span class="servarr-stat-value">{{ stats.tracks_on_disk | default: "0" }}</span>
              <span class="servarr-stat-label">Tracks</span>
            </div>
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_search }}</span>
              <span class="servarr-stat-value">{{ stats.monitored_missing | default: "0" }}</span>
              <span class="servarr-stat-label">Wanted</span>
            </div>
          {% when "readarr" %}
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_user }}</span>
              <span class="servarr-stat-value">{{ stats.total_authors | default: "0" }}</span>
              <span class="servarr-stat-label">Authors</span>
            </div>
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_book }}</span>
              <span class="servarr-stat-value">{{ stats.total_books | default: "0" }}</span>
              <span class="servarr-stat-label">Books</span>
            </div>
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_hdd }}</span>
              <span class="servarr-stat-value">{{ stats.books_on_disk | default: "0" }}</span>
              <span class="servarr-stat-label">On Disk</span>
            </div>
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_search }}</span>
              <span class="servarr-stat-value">{{ stats.monitored_missing | default: "0" }}</span>
              <span class="servarr-stat-label">Wanted</span>
            </div>
          {% when "prowlarr" %}
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_list }}</span>
              <span class="servarr-stat-value">{{ stats.total_indexers | default: "0" }}</span>
              <span class="servarr-stat-label">Indexers</span>
            </div>
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_search }}</span>
              <span class="servarr-stat-value">{{ stats.enabled_indexers | default: "0" }}</span>
              <span class="servarr-stat-label">Active</span>
            </div>
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_download }}</span>
              <span class="servarr-stat-value">{{ stats.total_grabs | default: "0" }}</span>
              <span class="servarr-stat-label">Grabs</span>
            </div>
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_search }}</span>
              <span class="servarr-stat-value">{{ stats.total_queries | default: "0" }}</span>
              <span class="servarr-stat-label">Queries</span>
            </div>
          {% else %}
            <div class="servarr-stat-box">
              <span class="servarr-stat-icon">{{ icon_download }}</span>
              <span class="servarr-stat-value">{{ queue.count | default: "0" }}</span>
              <span class="servarr-stat-label">Queue</span>
            </div>
        {% endcase %}
      </div>
      {% endif %}

      <!-- Recently Added or Upcoming Section -->
      {% if show_recently_added == "yes" or show_calendar == "yes" %}
      <div class="servarr-list-section">
        {% if show_recently_added == "yes" %}
          <div class="servarr-list-header">Recently Added</div>
          {% if recently_added.items and recently_added.items.size > 0 %}
            {% for item in recently_added.items limit: max_recently_added_items %}
              <div class="servarr-item">
                <div class="servarr-item-title">{{ item.title | truncate: 35 }}</div>
                <div class="servarr-item-meta">
                  <span>{{ item.time_ago }}</span>
                </div>
              </div>
            {% endfor %}
          {% else %}
            <div class="servarr-empty">Nothing recent</div>
          {% endif %}
        {% elsif show_calendar == "yes" %}
          <div class="servarr-list-header">Upcoming</div>
          {% if calendar.items and calendar.items.size > 0 %}
            {% for item in calendar.items limit: max_calendar_items %}
              <div class="servarr-item">
                <div class="servarr-item-title">{{ item.title | truncate: 35 }}</div>
                <div class="servarr-item-meta">
                  <span>
                    {% case date_format %}
                      {% when "relative" %}
                        {% if item.days_until == 0 %}Today{% elsif item.days_until == 1 %}Tomorrow{% else %}{{ item.air_date | date: "%b %d" }}{% endif %}
                      {% when "short" %}
                        {{ item.air_date | date: "%b %d" }}
                      {% else %}
                        {% if item.days_until == 0 %}Today{% elsif item.days_until == 1 %}Tomorrow{% else %}{{ item.air_date | date: "%b %d" }}{% endif %}
                    {% endcase %}
                    {% if item.air_date_time %} {{ item.air_date_time | date: "%s" | plus: trmnl.user.utc_offset | date: "%H:%M" }}{% endif %}
                  </span>
                  {% if show_network == "yes" and item.network %}
                    <span>{{ item.network }}</span>
                  {% endif %}
                </div>
              </div>
            {% endfor %}
          {% else %}
            <div class="servarr-empty">Nothing scheduled</div>
          {% endif %}
        {% endif %}
      </div>
      {% endif %}

    </div>
  </div>

</div>

<div class="title_bar">
  <span class="title">
    <span class="app-logo">
      {% case app_type %}
        {% when "sonarr" %}{{ logo_sonarr }}
        {% when "radarr" %}{{ logo_radarr }}
        {% when "lidarr" %}{{ logo_lidarr }}
        {% when "readarr" %}{{ logo_readarr }}
        {% when "prowlarr" %}{{ logo_prowlarr }}
      {% endcase %}
    </span>
    {{ app_name | default: "Servarr" }}
  </span>
  <span class="instance">
    {% if last_updated %}
      {{ last_updated | date: "%s" | plus: trmnl.user.utc_offset | date: "%H:%M" }}
    {% else %}
      --:--
    {% endif %}
  </span>
</div>
