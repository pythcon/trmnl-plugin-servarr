{% comment %}
  Full Layout (800x480) - Servarr Dashboard
  Supports: Dashboard mode (3-column) and Calendar modes (Daily, Weekly, Monthly)
  Supports: Sonarr, Radarr, Lidarr, Readarr, Prowlarr
{% endcomment %}

{% assign display_mode = trmnl.plugin_settings.custom_fields_values.display_mode | default: "dashboard" %}
{% assign show_queue = trmnl.plugin_settings.custom_fields_values.show_queue | default: "yes" | downcase %}
{% assign show_calendar = trmnl.plugin_settings.custom_fields_values.show_calendar | default: "yes" | downcase %}
{% assign show_recently_added = trmnl.plugin_settings.custom_fields_values.show_recently_added | default: "yes" | downcase %}
{% assign show_stats = trmnl.plugin_settings.custom_fields_values.show_stats | default: "yes" | downcase %}
{% assign max_queue = trmnl.plugin_settings.custom_fields_values.max_queue_items | default: 3 | plus: 0 %}
{% assign max_calendar_items = trmnl.plugin_settings.custom_fields_values.max_calendar_items | default: 3 | plus: 0 %}
{% assign max_recently_added_items = trmnl.plugin_settings.custom_fields_values.max_recently_added_items | default: 3 | plus: 0 %}
{% assign max_monthly_events_per_day = trmnl.plugin_settings.custom_fields_values.max_monthly_events_per_day | default: 2 | plus: 0 %}
{% assign show_health = trmnl.plugin_settings.custom_fields_values.show_health | default: "yes" | downcase %}
{% assign show_network = trmnl.plugin_settings.custom_fields_values.show_network | default: "yes" | downcase %}
{% assign show_quality = trmnl.plugin_settings.custom_fields_values.show_quality | default: "yes" | downcase %}
{% assign show_eta = trmnl.plugin_settings.custom_fields_values.show_eta | default: "yes" | downcase %}
{% assign date_format = trmnl.plugin_settings.custom_fields_values.date_format | default: "relative" | downcase %}
{% assign show_library_size = trmnl.plugin_settings.custom_fields_values.show_library_size | default: "yes" | downcase %}
{% assign show_wanted = trmnl.plugin_settings.custom_fields_values.show_wanted | default: "yes" | downcase %}

{% comment %} Count active columns for dynamic layout {% endcomment %}
{% assign col_count = 0 %}
{% if show_queue == "yes" %}{% assign col_count = col_count | plus: 1 %}{% endif %}
{% if show_recently_added == "yes" or show_calendar == "yes" %}{% assign col_count = col_count | plus: 1 %}{% endif %}
{% if show_stats == "yes" %}{% assign col_count = col_count | plus: 1 %}{% endif %}

{% comment %} SVG Icons {% endcomment %}
{%- capture icon_tv -%}<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="7" width="20" height="15" rx="2" ry="2"/><polyline points="17 2 12 7 7 2"/></svg>{%- endcapture -%}
{%- capture icon_film -%}<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18"/><line x1="7" y1="2" x2="7" y2="22"/><line x1="17" y1="2" x2="17" y2="22"/><line x1="2" y1="12" x2="22" y2="12"/><line x1="2" y1="7" x2="7" y2="7"/><line x1="2" y1="17" x2="7" y2="17"/><line x1="17" y1="17" x2="22" y2="17"/><line x1="17" y1="7" x2="22" y2="7"/></svg>{%- endcapture -%}
{%- capture icon_hdd -%}<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="12" x2="2" y2="12"/><path d="M5.45 5.11L2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z"/><line x1="6" y1="16" x2="6.01" y2="16"/><line x1="10" y1="16" x2="10.01" y2="16"/></svg>{%- endcapture -%}
{%- capture icon_search -%}<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>{%- endcapture -%}
{%- capture icon_database -%}<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg>{%- endcapture -%}
{%- capture icon_music -%}<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>{%- endcapture -%}
{%- capture icon_disc -%}<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="3"/></svg>{%- endcapture -%}
{%- capture icon_book -%}<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>{%- endcapture -%}
{%- capture icon_user -%}<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>{%- endcapture -%}
{%- capture icon_list -%}<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>{%- endcapture -%}
{%- capture icon_check -%}<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>{%- endcapture -%}
{%- capture icon_download -%}<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>{%- endcapture -%}

{% comment %} App Logos (from homarr-labs/dashboard-icons) {% endcomment %}
{%- capture logo_sonarr -%}<svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 512 512"><path d="M511.8 256c0 70.4-24.9 130.8-74.6 181.1-1.7 2-3.5 3.8-5.5 5.4-8.2 8-16.8 15.3-26 21.8Q341.05 512 256.3 512c-56.6 0-106.3-15.9-149.2-47.7-11.3-8-22-17.1-31.9-27.3C36.5 398.7 12.8 354 4 303.2c-1.7-9.9-2.9-20-3.4-30.2-.2-5.7-.4-11.3-.4-17 0-6 .1-11.7.4-17.1 0-.6.2-1.1.5-1.7 3.7-62.8 28.4-117 74.1-162.8C125.5 24.8 185.8 0 256.2 0c70.7 0 131 24.8 180.9 74.5q74.7 75.9 74.7 181.5" fill="#eee"/><path d="m459.7 100.3-52.9 52.9c-30.9 30.9-33.6 57.8-33.6 105.3 0 42.3 6.7 81.1 38.2 112.6 23 23 44.9 44.7 44.9 44.7-5.9 7.2-12.3 14.3-19.1 21.2-1.7 2-3.5 3.8-5.5 5.4-6 5.9-12.2 11.4-18.6 16.4l-41.4-41.4C334.9 380.6 305.6 377 257 377c-46.7 0-78.4 4.3-112.6 38.5-20.4 20.4-43.8 43.9-43.8 43.9-8.9-6.8-17.3-14.2-25.3-22.4-6.6-6.6-12.8-13.4-18.5-20.3 0 0 23.1-23.2 45.2-45.3 32.7-32.7 38-70.6 38-113 0-41.3-6.8-79.8-36.8-109.9C82.2 127.7 53.3 99 53.3 99c6.7-8.5 14-16.7 21.8-24.5 6.9-6.8 14-13.1 21.2-19l48 48c30.7 30.7 70 38.6 112.4 38.6 43.6 0 82.8-8.4 114.7-40.4C391 82.1 417 56.3 417 56.3c6.8 5.6 13.5 11.6 20.1 18.2 8.3 8.3 15.8 16.9 22.6 25.8" fill="#3a3f51"/><path d="M186 269.1c-.5-2.8-.8-5.5-.9-8.4-.1-1.6-.1-3.1-.1-4.7 0-1.7 0-3.2.1-4.7 0-.2 0-.3.1-.5 1-17.4 7.9-32.4 20.5-45.1 13.9-13.8 30.6-20.7 50.2-20.7s36.3 6.9 50.2 20.7c13.8 14 20.7 30.8 20.7 50.3s-6.9 36.2-20.7 50.2c-.5.5-1 1.1-1.5 1.5q-3.45 3.3-7.2 6-18 13.2-41.4 13.2c-23.4 0-29.4-4.4-41.3-13.2-3.1-2.2-6.1-4.7-8.9-7.6-10.8-10.6-17.3-22.9-19.8-37" fill="#0cf"/><path d="m372.7 141-35.4 34.6M72.9 76.8l96.5 96.1m199.7 198.9 65.6 67.9m4.4-363.3L372.7 141M76.6 438.5l64.6-64.7" fill="none" stroke="#0cf" stroke-width="2"/><path d="m372.7 141-40 40.6m-193.3-38.5 40.6 40.5M141 374l39.5-41.1m146.2-3.3 42.6 42.4" fill="none" stroke="#0cf" stroke-width="7"/></svg>{%- endcapture -%}
{%- capture logo_radarr -%}<svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 512 512"><g transform="translate(70 21)"><path d="m10.3 59.8 3.9 372.4c-31.4 3.9-54.9-11.8-54.9-43.1l-3.9-309.7c0-98 90.2-121.5 145.1-82.3l278.3 160.7c39.2 27.4 47 78.4 27.4 113.7-3.9-27.4-15.7-43.1-39.2-58.8L53.4 36.2C29.9 20.6 10.3 24.5 10.3 59.8" fill="#24292e"/><path d="M-13.2 451.8c23.5 7.8 47 3.9 66.6-7.8l321.5-188.2c19.6 27.4 15.7 54.9-7.8 70.6L96.5 483.2c-39.2 19.6-90.1 0-109.7-31.4" fill="#24292e"/><path d="M80.9 342 273 232.3 84.8 126.4z" fill="#ffc230"/></g></svg>{%- endcapture -%}
{%- capture logo_lidarr -%}<svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 512 512"><circle cx="256" cy="256" r="256" fill="#1fda9a"/><circle cx="256" cy="256" r="200" fill="#19b87f"/><path d="M180 180v152l152-76z" fill="#fff"/></svg>{%- endcapture -%}
{%- capture logo_readarr -%}<svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 512 512"><circle cx="256" cy="256" r="256" fill="#eee" stroke="#443c3c" stroke-width="1.5"/><circle cx="256" cy="256" r="220.9" fill="#443c3c"/><circle cx="256" cy="256" r="194.3" fill="#8e2222"/><circle cx="256" cy="256" r="189.7" fill="#eee" stroke="#8e2222" stroke-width="1.5"/><circle cx="255.3" cy="256.7" r="133" fill="#443c3c"/><path d="M87.2 341s-2.5-178.7-2.9-179c.3-26.7 8.8-24 15.3-24.8 99.7 5.4 136 35.8 138.2 36.9 6.7 2.5 10.5 16 10.2 15.6.3.3 2.2 211.1 1.9 210.8 1.6 11.3-6.7 10.5-7 10.2-62.7-49.3-149.4-61.7-149.7-62-6-.5-6-7.7-6-7.7z" fill="#eee" stroke="#8e2222" stroke-width="10"/><path d="M423.5 341.4s2.5-179.1 2.9-179.5c-.3-26.7-8.8-24.1-15.3-24.9-99.7 5.4-136 35.9-138.2 37-6.7 2.5-10.5 16-10.2 15.7-.3.3-2.2 211.6-1.9 211.3-1.6 11.3 6.7 10.6 7 10.2 62.7-49.4 149.4-61.8 149.7-62.2 6-.3 6-7.6 6-7.6z" fill="#eee" stroke="#8e2222" stroke-width="10"/><path d="M85.9 369.7S83.3 191 83 190.7c.3-26.7 8.9-24 15.5-24.8 101.3 5.4 138.2 35.8 140.4 36.9 6.8 2.5 10.7 16 10.4 15.6.3.3 2.3 211.1 1.9 210.8 1.6 11.3-6.8 10.5-7.1 10.2-63.8-49.3-151.8-61.7-152.1-62-6.1-.4-6.1-7.7-6.1-7.7z" fill="#8e2222" stroke="#8e2222" stroke-width="5"/><path d="M424.8 370s2.6-179.1 2.9-179.5c-.3-26.7-8.9-24.1-15.5-24.9-101.3 5.4-138.2 35.9-140.5 37-6.8 2.5-10.7 16-10.4 15.7-.3.3-2.3 211.6-1.9 211.3-1.6 11.3 6.8 10.6 7.1 10.2 63.8-49.4 151.8-61.8 152.1-62.2 6.2-.3 6.2-7.6 6.2-7.6z" fill="#8e2222" stroke="#8e2222" stroke-width="5"/></svg>{%- endcapture -%}
{%- capture logo_prowlarr -%}<svg xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 512 512"><circle cx="256" cy="256" r="245" fill="#ffe6d5"/><path d="m132 314 8 10 61 .2-8-10z" fill="#83331b"/><path d="M132 314v-26c5-.2 8-2 8-4h47c-.4.5-.6 1.1-.6 1.7 0 2.2 2.7 4 6.2 4.2v24z" fill="#f8a37b"/><path d="M167 310c1 .5 3 2 2 4l-.5.6h4c-.5-1.2-2.4-2.6-2.4-2.6s-.2-.3-1-1c-.6-.3-1.3-.6-1.8-.7m-12 0c-.5.2-1.2.6-1.7 1.2-.9.9-1 2.1-1 2.1l-.6 1h2.4c-.2-.1-.3-.3-.5-.6-.9-1.6.5-3.1 1.4-3.7m11 0c-.5.1-1.5.2-2.5.5-1.5.5-2.3 1.6-2.3 1.6s-1.6-1-3.8-1.4c-.7-.1-1.2-.2-1.5-.2 0 .7-.2 1.5-.2 1.5s-.4 1.3-1 1.7h13c-.6-.4-1-1.7-1-1.7s-.3-1.1-.3-2" fill="#da845d"/><circle cx="256" cy="256" r="245" fill="none" stroke="#e66001" stroke-width="22"/><path d="M140 336s7 9 22 7c15-2 20-21 20-21l-6-8h-36z" fill="#ef5d22"/><path d="m118 314-2 3s8 16 18 19c11 4 19-2 24-6s8-14 8-14l-2-2z" fill="#f46a2f"/><path d="m116 316 7 2s-2 7 4 10 9 0 10-2 1-7 1-7h8s0 8 3 10 8 3 10-2 0-8 0-8l9-4-2-2h-46z" fill="#fff"/><path d="M147 323c0-2-1-3-3-3s-3 1-3 3 1 3 3 3 3-1 3-3" fill="#fddd04"/><path d="M148 323c0-1-1-2-2-2s-2 1-2 2 1 2 2 2 2-1 2-2" fill="#391913"/><path d="M164 323c0-2-1-3-3-3s-3 1-3 3 1 3 3 3 3-1 3-3" fill="#fddd04"/><path d="M163 323c0-1-1-2-2-2s-2 1-2 2 1 2 2 2 2-1 2-2" fill="#391913"/><path d="M380 314v-26c-5-.2-8-2-8-4h-47c.4.5.6 1.1.6 1.7 0 2.2-2.7 4-6.2 4.2v24z" fill="#f8a37b"/><path d="M380 314l-8 10-61 .2 8-10z" fill="#83331b"/><path d="M345 310c-1 .5-3 2-2 4l.5.6h-4c.5-1.2 2.4-2.6 2.4-2.6s.2-.3 1-1c.6-.3 1.3-.6 1.8-.7m12 0c.5.2 1.2.6 1.7 1.2.9.9 1 2.1 1 2.1l.6 1h-2.4c.2-.1.3-.3.5-.6.9-1.6-.5-3.1-1.4-3.7m-11 0c.5.1 1.5.2 2.5.5 1.5.5 2.3 1.6 2.3 1.6s1.6-1 3.8-1.4c.7-.1 1.2-.2 1.5-.2 0 .7.2 1.5.2 1.5s.4 1.3 1 1.7h-13c.6-.4 1-1.7 1-1.7s.3-1.1.3-2" fill="#da845d"/><path d="M372 336s-7 9-22 7c-15-2-20-21-20-21l6-8h36z" fill="#ef5d22"/><path d="m394 314 2 3s-8 16-18 19c-11 4-19-2-24-6s-8-14-8-14l2-2z" fill="#f46a2f"/><path d="m396 316-7 2s2 7-4 10-9 0-10-2-1-7-1-7h-8s0 8-3 10-8 3-10-2 0-8 0-8l-9-4 2-2h46z" fill="#fff"/><path d="M365 323c0-2 1-3 3-3s3 1 3 3-1 3-3 3-3-1-3-3" fill="#fddd04"/><path d="M364 323c0-1 1-2 2-2s2 1 2 2-1 2-2 2-2-1-2-2" fill="#391913"/><path d="M348 323c0-2 1-3 3-3s3 1 3 3-1 3-3 3-3-1-3-3" fill="#fddd04"/><path d="M349 323c0-1 1-2 2-2s2 1 2 2-1 2-2 2-2-1-2-2" fill="#391913"/></svg>{%- endcapture -%}

<style>
  /* ===== APP LOGO ===== */
  .app-logo {
    display: inline-flex;
    align-items: center;
    margin-right: 6px;
    vertical-align: middle;
  }
  .app-logo svg {
    height: 20px;
    width: auto;
  }
  /* ===== DASHBOARD STYLES ===== */
  .servarr-full {
    display: flex;
    flex-direction: row;
    gap: 12px;
    padding: 16px;
    height: 430px;
    box-sizing: border-box;
  }
  .servarr-col {
    display: flex;
    flex-direction: column;
    gap: 8px;
    overflow: hidden;
    flex: 1;
    min-width: 0;
  }
  /* When all 3 columns visible: queue=fixed, middle=flex, library=fixed */
  .servarr-full--cols-3 .servarr-col--queue {
    flex: 0 0 230px;
  }
  .servarr-full--cols-3 .servarr-col--upcoming {
    flex: 1;
  }
  .servarr-full--cols-3 .servarr-col--library {
    flex: 0 0 180px;
  }
  /* When 2 columns: expand to fill space */
  .servarr-full--cols-2 .servarr-col--queue {
    flex: 2;
  }
  .servarr-full--cols-2 .servarr-col--upcoming {
    flex: 3;
  }
  .servarr-full--cols-2 .servarr-col--library {
    flex: 2;
  }
  /* When 1 column: full width */
  .servarr-full--cols-1 .servarr-col {
    flex: 1;
  }
  /* Adjust item widths for wider columns */
  .servarr-full--cols-2 .servarr-item-title,
  .servarr-full--cols-1 .servarr-item-title {
    max-width: 100%;
  }
  .servarr-full--cols-1 .servarr-stats-grid {
    grid-template-columns: repeat(4, 1fr);
  }
  .servarr-full--cols-1 .servarr-stat-full {
    grid-column: span 4;
  }
  .servarr-card {
    background: white;
    border: 3px solid black;
    border-radius: 8px;
    padding: 10px;
    display: flex;
    flex-direction: column;
    gap: 6px;
    height: 100%;
    overflow: hidden;
  }
  .servarr-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-bottom: 6px;
    border-bottom: 1px dashed #ccc;
  }
  .servarr-header-title {
    font-family: 'DepartureMono', monospace;
    font-size: 18px;
    font-weight: bold;
  }
  .servarr-badge {
    font-family: 'DepartureMono', monospace;
    font-size: 12px;
    background: #e5e5e5;
    padding: 2px 6px;
    border-radius: 4px;
  }
  .servarr-content {
    display: flex;
    flex-direction: column;
    gap: 6px;
    flex: 1;
    justify-content: flex-start;
  }
  .servarr-item {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }
  .servarr-item-title {
    font-family: 'DepartureMono', monospace;
    font-size: 14px;
    font-weight: bold;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .servarr-item-meta {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-family: 'DepartureMono', monospace;
    font-size: 11px;
    color: #333;
  }
  .servarr-progress {
    width: 100%;
    height: 4px;
    background: #e5e5e5;
    border-radius: 2px;
  }
  .servarr-progress-bar {
    height: 100%;
    background: black;
    border-radius: 2px;
  }
  .servarr-stats-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 6px;
    flex: 1;
  }
  .servarr-stat-box {
    border: 2px solid black;
    border-radius: 6px;
    padding: 6px 4px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 2px;
  }
  .servarr-stat-icon {
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .servarr-stat-value {
    font-family: 'DepartureMono', monospace;
    font-size: 20px;
    font-weight: bold;
    line-height: 1;
  }
  .servarr-stat-label {
    font-family: 'DepartureMono', monospace;
    font-size: 10px;
    color: #333;
  }
  .servarr-stat-full {
    grid-column: span 2;
  }
  .servarr-empty {
    font-family: 'DepartureMono', monospace;
    font-size: 12px;
    color: #666;
    text-align: center;
  }
  .servarr-col--split {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .servarr-card--half {
    flex: 1;
    min-height: 0;
  }

  /* ===== CALENDAR STYLES ===== */
  .calendar-container {
    padding: 12px;
    height: 430px;
    box-sizing: border-box;
  }
  .calendar-card {
    background: white;
    border: 3px solid black;
    border-radius: 8px;
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  .calendar-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    border-bottom: 2px solid black;
  }
  .calendar-title {
    font-family: 'DepartureMono', monospace;
    font-size: 20px;
    font-weight: bold;
  }
  .calendar-subtitle {
    font-family: 'DepartureMono', monospace;
    font-size: 12px;
    color: #666;
  }

  /* Weekly Grid */
  .calendar-week-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    flex: 1;
    overflow: hidden;
  }
  .calendar-day-col {
    border-right: 1px solid #ddd;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  .calendar-day-col:last-child {
    border-right: none;
  }
  .calendar-day-header {
    padding: 8px 4px;
    text-align: center;
    border-bottom: 1px solid #ddd;
    background: #f5f5f5;
  }
  .calendar-day-name {
    font-family: 'DepartureMono', monospace;
    font-size: 11px;
    font-weight: bold;
    text-transform: uppercase;
  }
  .calendar-day-date {
    font-family: 'DepartureMono', monospace;
    font-size: 18px;
    font-weight: bold;
  }
  .calendar-day-header.today {
    background: black;
    color: white;
  }
  .calendar-day-items {
    flex: 1;
    padding: 4px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    gap: 4px;
  }
  .calendar-event {
    background: #f0f0f0;
    border-left: 3px solid black;
    padding: 4px 6px;
    border-radius: 0 4px 4px 0;
  }
  .calendar-event-title {
    font-family: 'DepartureMono', monospace;
    font-size: 10px;
    font-weight: bold;
    line-height: 1.2;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  .calendar-event-time {
    font-family: 'DepartureMono', monospace;
    font-size: 9px;
    color: #666;
  }
  .calendar-more {
    font-family: 'DepartureMono', monospace;
    font-size: 9px;
    color: #666;
    text-align: center;
    padding: 2px;
  }

  /* Daily View */
  .calendar-daily {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  .calendar-daily-header {
    padding: 16px;
    text-align: center;
    border-bottom: 2px solid black;
    background: #f5f5f5;
  }
  .calendar-daily-date {
    font-family: 'DepartureMono', monospace;
    font-size: 32px;
    font-weight: bold;
  }
  .calendar-daily-day {
    font-family: 'DepartureMono', monospace;
    font-size: 14px;
    color: #666;
  }
  .calendar-daily-items {
    flex: 1;
    padding: 12px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .calendar-daily-event {
    background: #f5f5f5;
    border: 2px solid black;
    border-radius: 6px;
    padding: 10px 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .calendar-daily-event-info {
    flex: 1;
    min-width: 0;
  }
  .calendar-daily-event-title {
    font-family: 'DepartureMono', monospace;
    font-size: 14px;
    font-weight: bold;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .calendar-daily-event-meta {
    font-family: 'DepartureMono', monospace;
    font-size: 11px;
    color: #666;
  }
  .calendar-daily-event-time {
    font-family: 'DepartureMono', monospace;
    font-size: 16px;
    font-weight: bold;
    padding-left: 12px;
  }

  /* Monthly Grid */
  .calendar-month-grid {
    display: flex;
    flex-direction: column;
    flex: 1;
    overflow: hidden;
  }
  .calendar-month-header-row {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    background: #f5f5f5;
    border-bottom: 2px solid black;
  }
  .calendar-month-header-cell {
    padding: 6px;
    text-align: center;
    font-family: 'DepartureMono', monospace;
    font-size: 11px;
    font-weight: bold;
    text-transform: uppercase;
    border-right: 1px solid #ddd;
  }
  .calendar-month-header-cell:last-child {
    border-right: none;
  }
  .calendar-month-body {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    grid-template-rows: repeat(5, 1fr);
    flex: 1;
  }
  .calendar-month-cell {
    border-right: 1px solid #ddd;
    border-bottom: 1px solid #ddd;
    padding: 4px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    min-height: 0;
  }
  .calendar-month-cell:nth-child(7n) {
    border-right: none;
  }
  .calendar-month-cell.other-month {
    background: #fafafa;
    color: #999;
  }
  .calendar-month-cell.today {
    background: #f0f0f0;
  }
  .calendar-month-day-num {
    font-family: 'DepartureMono', monospace;
    font-size: 12px;
    font-weight: bold;
    margin-bottom: 2px;
  }
  .calendar-month-cell.today .calendar-month-day-num {
    background: black;
    color: white;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .calendar-month-events {
    flex: 1;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    gap: 1px;
  }
  .calendar-month-event {
    background: black;
    color: white;
    font-family: 'DepartureMono', monospace;
    font-size: 8px;
    padding: 1px 3px;
    border-radius: 2px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .calendar-month-more {
    font-family: 'DepartureMono', monospace;
    font-size: 8px;
    color: #666;
  }
</style>

{% case display_mode %}
{% when "calendar_-_daily" %}
<!-- ===== DAILY CALENDAR VIEW ===== -->
<div class="calendar-container">
  <div class="calendar-card">
    <div class="calendar-header">
      <div>
        <div class="calendar-title">Today's Releases</div>
        <div class="calendar-subtitle">{{ "now" | date: "%A, %B %d, %Y" }}</div>
      </div>
      <span class="servarr-badge">{% assign today_count = 0 %}{% for item in calendar.items %}{% if item.days_until == 0 %}{% assign today_count = today_count | plus: 1 %}{% endif %}{% endfor %}{{ today_count }}</span>
    </div>
    <div class="calendar-daily-items">
      {% assign has_items = false %}
      {% for item in calendar.items %}
        {% if item.days_until == 0 %}
          {% assign has_items = true %}
          <div class="calendar-daily-event">
            <div class="calendar-daily-event-info">
              <div class="calendar-daily-event-title">{{ item.title }}</div>
              <div class="calendar-daily-event-meta">
                {% if show_network == "yes" and item.network %}{{ item.network }}{% endif %}
              </div>
            </div>
            {% if item.air_date_time %}
            <div class="calendar-daily-event-time">{{ item.air_date_time | date: "%s" | plus: trmnl.user.utc_offset | date: "%H:%M" }}</div>
            {% endif %}
          </div>
        {% endif %}
      {% endfor %}
      {% unless has_items %}
        <div class="servarr-empty">No releases today</div>
      {% endunless %}
    </div>
  </div>
</div>

{% when "calendar_-_weekly" %}
<!-- ===== WEEKLY CALENDAR VIEW ===== -->
{% comment %}
  Weekly view always starts on Sunday.
  We calculate today's day-of-week (0=Sun, 6=Sat) dynamically from last_updated.
  Then each column shows Sun-Sat with proper days_until mapping.
{% endcomment %}
{% assign today_timestamp = last_updated | date: "%s" | plus: 0 %}
{% assign today_dow = last_updated | date: "%w" | plus: 0 %}
{% assign seconds_per_day = 86400 %}
{% assign days_back_to_sunday = today_dow | times: seconds_per_day %}
{% assign week_start_timestamp = today_timestamp | minus: days_back_to_sunday %}
<div class="calendar-container">
  <div class="calendar-card">
    <div class="calendar-header">
      <div>
        <div class="calendar-title">This Week</div>
        <div class="calendar-subtitle">{{ calendar.count }} upcoming releases</div>
      </div>
    </div>
    <div class="calendar-week-grid">
      {% comment %} Generate 7 days: Sunday through Saturday {% endcomment %}
      {% for col in (0..6) %}
        {% assign col_days_until = col | minus: today_dow | plus: 0 %}{% comment %} days_until relative to today (plus: 0 ensures integer) {% endcomment %}
        {% assign is_today = false %}
        {% if col == today_dow %}{% assign is_today = true %}{% endif %}
        {% assign day_offset_seconds = col | times: seconds_per_day %}
        {% assign day_timestamp = week_start_timestamp | plus: day_offset_seconds %}
        {% assign day_name = day_timestamp | date: "%a" %}
        {% assign day_num = day_timestamp | date: "%-d" %}
        <div class="calendar-day-col">
          <div class="calendar-day-header{% if is_today %} today{% endif %}">
            <div class="calendar-day-name">{{ day_name }}</div>
            <div class="calendar-day-date">{{ day_num }}</div>
          </div>
          <div class="calendar-day-items">
            {% assign day_count = 0 %}
            {% assign shown_count = 0 %}
            {% for item in calendar.items %}
              {% assign item_days_until = item.days_until | plus: 0 %}
              {% if item_days_until == col_days_until %}
                {% assign day_count = day_count | plus: 1 %}
                {% if shown_count < max_calendar_items %}
                  <div class="calendar-event">
                    <div class="calendar-event-title">{{ item.title }}</div>
                    {% if item.air_date_time %}<div class="calendar-event-time">{{ item.air_date_time | date: "%s" | plus: trmnl.user.utc_offset | date: "%H:%M" }}</div>{% endif %}
                  </div>
                  {% assign shown_count = shown_count | plus: 1 %}
                {% endif %}
              {% endif %}
            {% endfor %}
            {% assign remaining = day_count | minus: shown_count %}
            {% if remaining > 0 %}
              <div class="calendar-more">+{{ remaining }} more</div>
            {% endif %}
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</div>

{% when "calendar_-_monthly" %}
<!-- ===== MONTHLY CALENDAR VIEW ===== -->
{% comment %}
  Dynamic monthly calendar - calculates all dates from last_updated.
  Uses Unix timestamp arithmetic (86400 seconds per day).
{% endcomment %}
{% assign current_month_num = last_updated | date: "%m" %}
{% assign current_month_name = last_updated | date: "%B" %}
{% assign current_year = last_updated | date: "%Y" %}
{% assign current_day = last_updated | date: "%-d" | plus: 0 %}
{% assign seconds_per_day = 86400 %}

{% comment %} Build first-of-month string and get its timestamp and day-of-week {% endcomment %}
{% assign first_of_month_str = current_year | append: "-" | append: current_month_num | append: "-01" %}
{% assign first_of_month_ts = first_of_month_str | date: "%s" | plus: 0 %}
{% assign first_dow = first_of_month_str | date: "%w" | plus: 0 %}

{% comment %} Calculate the start of the calendar grid (may be in previous month) {% endcomment %}
{% assign grid_start_offset = first_dow | times: seconds_per_day %}
{% assign grid_start_ts = first_of_month_ts | minus: grid_start_offset %}

<div class="calendar-container">
  <div class="calendar-card">
    <div class="calendar-header">
      <div>
        <div class="calendar-title">{{ current_month_name }} {{ current_year }}</div>
        <div class="calendar-subtitle">{{ calendar.count }} releases this month</div>
      </div>
    </div>
    <div class="calendar-month-grid">
      <div class="calendar-month-header-row">
        <div class="calendar-month-header-cell">Sun</div>
        <div class="calendar-month-header-cell">Mon</div>
        <div class="calendar-month-header-cell">Tue</div>
        <div class="calendar-month-header-cell">Wed</div>
        <div class="calendar-month-header-cell">Thu</div>
        <div class="calendar-month-header-cell">Fri</div>
        <div class="calendar-month-header-cell">Sat</div>
      </div>
      <div class="calendar-month-body">
        {% comment %} Generate 35 cells (5 weeks x 7 days) {% endcomment %}
        {% for cell in (0..34) %}
          {% assign cell_offset = cell | times: seconds_per_day %}
          {% assign cell_ts = grid_start_ts | plus: cell_offset %}
          {% assign cell_day = cell_ts | date: "%-d" | plus: 0 %}
          {% assign cell_month = cell_ts | date: "%m" %}
          {% assign cell_date_str = cell_ts | date: "%Y-%m-%d" %}

          {% comment %} Determine if this cell is in the current month {% endcomment %}
          {% assign is_current_month = false %}
          {% if cell_month == current_month_num %}{% assign is_current_month = true %}{% endif %}

          {% comment %} Determine if this is today {% endcomment %}
          {% assign is_today = false %}
          {% if is_current_month and cell_day == current_day %}{% assign is_today = true %}{% endif %}

          <div class="calendar-month-cell{% if is_today %} today{% endif %}{% unless is_current_month %} other-month{% endunless %}">
            <div class="calendar-month-day-num">{{ cell_day }}</div>
            {% if is_current_month %}
            <div class="calendar-month-events">
              {% assign event_count = 0 %}
              {% for item in calendar.items %}
                {% assign item_date = item.air_date | date: "%Y-%m-%d" %}
                {% if item_date == cell_date_str %}
                  {% if event_count < max_monthly_events_per_day %}
                    <div class="calendar-month-event">{{ item.title | truncate: 12 }}</div>
                  {% endif %}
                  {% assign event_count = event_count | plus: 1 %}
                {% endif %}
              {% endfor %}
              {% if event_count > max_monthly_events_per_day %}
                <div class="calendar-month-more">+{{ event_count | minus: max_monthly_events_per_day }} more</div>
              {% endif %}
            </div>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>

{% else %}
<!-- ===== DASHBOARD VIEW (Default) ===== -->
<div class="servarr-full servarr-full--cols-{{ col_count }}">

  <!-- Queue Column -->
  {% if show_queue == "yes" %}
  <div class="servarr-col servarr-col--queue">
    <div class="servarr-card">
      <div class="servarr-header">
        <span class="servarr-header-title">Queue</span>
        <span class="servarr-badge">{{ queue.count | default: 0 }}</span>
      </div>
      <div class="servarr-content">
        {% if queue.items and queue.items.size > 0 %}
          {% for item in queue.items limit: max_queue %}
            <div class="servarr-item">
              <div class="servarr-item-title">{{ item.title | truncate: 28 }}</div>
              <div class="servarr-item-meta">
                {% if show_quality == "yes" %}<span>{{ item.quality }}</span>{% endif %}
                {% if show_eta == "yes" %}<span>{{ item.eta }}</span>{% endif %}
              </div>
              <div class="servarr-progress">
                <div class="servarr-progress-bar" style="width: {{ item.progress | default: 0 }}%;"></div>
              </div>
            </div>
          {% endfor %}
          {% assign remaining = queue.count | minus: max_queue %}
          {% if remaining > 0 %}
            <div class="servarr-empty">+{{ remaining }} more</div>
          {% endif %}
        {% else %}
          <div class="servarr-empty">Queue empty</div>
        {% endif %}
      </div>
    </div>
  </div>
  {% endif %}

  <!-- Middle Column: Recently Added + Upcoming -->
  {% if show_recently_added == "yes" or show_calendar == "yes" %}
  <div class="servarr-col servarr-col--upcoming{% if show_recently_added == "yes" and show_calendar == "yes" %} servarr-col--split{% endif %}">

    {% if show_recently_added == "yes" %}
    <div class="servarr-card{% if show_calendar == "yes" %} servarr-card--half{% endif %}">
      <div class="servarr-header">
        <span class="servarr-header-title">Recently Added</span>
        <span class="servarr-badge">{{ recently_added.count | default: 0 }}</span>
      </div>
      <div class="servarr-content">
        {% if recently_added.items and recently_added.items.size > 0 %}
          {% for item in recently_added.items limit: max_recently_added_items %}
            <div class="servarr-item">
              <div class="servarr-item-title">{{ item.title | truncate: 35 }}</div>
              <div class="servarr-item-meta">
                <span>{{ item.time_ago }}</span>
              </div>
            </div>
          {% endfor %}
          {% assign remaining_added = recently_added.count | minus: max_recently_added_items %}
          {% if remaining_added > 0 %}
            <div class="servarr-empty">+{{ remaining_added }} more</div>
          {% endif %}
        {% else %}
          <div class="servarr-empty">Nothing recent</div>
        {% endif %}
      </div>
    </div>
    {% endif %}

    {% if show_calendar == "yes" %}
    <div class="servarr-card{% if show_recently_added == "yes" %} servarr-card--half{% endif %}">
      <div class="servarr-header">
        <span class="servarr-header-title">Upcoming</span>
        <span class="servarr-badge">{{ calendar.count | default: 0 }}</span>
      </div>
      <div class="servarr-content">
        {% if calendar.items and calendar.items.size > 0 %}
          {% for item in calendar.items limit: max_calendar_items %}
            <div class="servarr-item">
              <div class="servarr-item-title">{{ item.title | truncate: 35 }}</div>
              <div class="servarr-item-meta">
                <span>
                  {% case date_format %}
                    {% when "relative" %}
                      {% if item.days_until == 0 %}Today{% elsif item.days_until == 1 %}Tomorrow{% else %}{{ item.air_date | date: "%b %d" }}{% endif %}
                    {% when "short" %}
                      {{ item.air_date | date: "%b %d" }}
                    {% when "full" %}
                      {{ item.air_date | date: "%B %d" }}
                    {% else %}
                      {% if item.days_until == 0 %}Today{% elsif item.days_until == 1 %}Tomorrow{% else %}{{ item.air_date | date: "%b %d" }}{% endif %}
                  {% endcase %}
                  {% if item.air_date_time %} {{ item.air_date_time | date: "%s" | plus: trmnl.user.utc_offset | date: "%H:%M" }}{% endif %}
                </span>
                {% if show_network == "yes" and item.network %}
                  <span>{{ item.network }}</span>
                {% endif %}
              </div>
            </div>
          {% endfor %}
          {% assign remaining_cal = calendar.count | minus: max_calendar_items %}
          {% if remaining_cal > 0 %}
            <div class="servarr-empty">+{{ remaining_cal }} more</div>
          {% endif %}
        {% else %}
          <div class="servarr-empty">Nothing scheduled</div>
        {% endif %}
      </div>
    </div>
    {% endif %}

  </div>
  {% endif %}

  <!-- Library Column -->
  {% if show_stats == "yes" %}
  <div class="servarr-col servarr-col--library">
    <div class="servarr-card">
      <div class="servarr-header">
        <span class="servarr-header-title">Library</span>
        {% if show_health == "yes" and health.status %}
          <span class="servarr-badge">{{ health.status | capitalize }}</span>
        {% endif %}
      </div>
      <div class="servarr-content">
        <div class="servarr-stats-grid">
          {% case app_type %}
            {% when "sonarr" %}
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_tv }}</span>
                <span class="servarr-stat-value">{{ stats.total_series | default: "0" }}</span>
                <span class="servarr-stat-label">Series</span>
              </div>
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_film }}</span>
                <span class="servarr-stat-value">{{ stats.total_episodes | default: "0" }}</span>
                <span class="servarr-stat-label">Episodes</span>
              </div>
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_hdd }}</span>
                <span class="servarr-stat-value">{{ stats.episodes_on_disk | default: "0" }}</span>
                <span class="servarr-stat-label">On Disk</span>
              </div>
              {% if show_wanted == "yes" %}
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_search }}</span>
                <span class="servarr-stat-value">{{ stats.monitored_missing | default: "0" }}</span>
                <span class="servarr-stat-label">Wanted</span>
              </div>
              {% endif %}
              {% if show_library_size == "yes" and stats.library_size_formatted %}
              <div class="servarr-stat-box servarr-stat-full">
                <span class="servarr-stat-icon">{{ icon_database }}</span>
                <span class="servarr-stat-value">{{ stats.library_size_formatted }}</span>
                <span class="servarr-stat-label">Size</span>
              </div>
              {% endif %}

            {% when "radarr" %}
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_film }}</span>
                <span class="servarr-stat-value">{{ stats.total_movies | default: "0" }}</span>
                <span class="servarr-stat-label">Movies</span>
              </div>
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_hdd }}</span>
                <span class="servarr-stat-value">{{ stats.movies_on_disk | default: "0" }}</span>
                <span class="servarr-stat-label">On Disk</span>
              </div>
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_search }}</span>
                <span class="servarr-stat-value">{{ stats.movies_missing | default: "0" }}</span>
                <span class="servarr-stat-label">Missing</span>
              </div>
              {% if show_wanted == "yes" %}
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_search }}</span>
                <span class="servarr-stat-value">{{ stats.monitored_missing | default: "0" }}</span>
                <span class="servarr-stat-label">Wanted</span>
              </div>
              {% endif %}
              {% if show_library_size == "yes" and stats.library_size_formatted %}
              <div class="servarr-stat-box servarr-stat-full">
                <span class="servarr-stat-icon">{{ icon_database }}</span>
                <span class="servarr-stat-value">{{ stats.library_size_formatted }}</span>
                <span class="servarr-stat-label">Size</span>
              </div>
              {% endif %}

            {% when "lidarr" %}
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_user }}</span>
                <span class="servarr-stat-value">{{ stats.total_artists | default: "0" }}</span>
                <span class="servarr-stat-label">Artists</span>
              </div>
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_disc }}</span>
                <span class="servarr-stat-value">{{ stats.total_albums | default: "0" }}</span>
                <span class="servarr-stat-label">Albums</span>
              </div>
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_music }}</span>
                <span class="servarr-stat-value">{{ stats.total_tracks | default: "0" }}</span>
                <span class="servarr-stat-label">Tracks</span>
              </div>
              {% if show_wanted == "yes" %}
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_search }}</span>
                <span class="servarr-stat-value">{{ stats.monitored_missing | default: "0" }}</span>
                <span class="servarr-stat-label">Wanted</span>
              </div>
              {% endif %}
              {% if show_library_size == "yes" and stats.library_size_formatted %}
              <div class="servarr-stat-box servarr-stat-full">
                <span class="servarr-stat-icon">{{ icon_database }}</span>
                <span class="servarr-stat-value">{{ stats.library_size_formatted }}</span>
                <span class="servarr-stat-label">Size</span>
              </div>
              {% endif %}

            {% when "readarr" %}
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_user }}</span>
                <span class="servarr-stat-value">{{ stats.total_authors | default: "0" }}</span>
                <span class="servarr-stat-label">Authors</span>
              </div>
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_book }}</span>
                <span class="servarr-stat-value">{{ stats.total_books | default: "0" }}</span>
                <span class="servarr-stat-label">Books</span>
              </div>
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_hdd }}</span>
                <span class="servarr-stat-value">{{ stats.books_on_disk | default: "0" }}</span>
                <span class="servarr-stat-label">On Disk</span>
              </div>
              {% if show_wanted == "yes" %}
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_search }}</span>
                <span class="servarr-stat-value">{{ stats.monitored_missing | default: "0" }}</span>
                <span class="servarr-stat-label">Wanted</span>
              </div>
              {% endif %}
              {% if show_library_size == "yes" and stats.library_size_formatted %}
              <div class="servarr-stat-box servarr-stat-full">
                <span class="servarr-stat-icon">{{ icon_database }}</span>
                <span class="servarr-stat-value">{{ stats.library_size_formatted }}</span>
                <span class="servarr-stat-label">Size</span>
              </div>
              {% endif %}

            {% when "prowlarr" %}
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_list }}</span>
                <span class="servarr-stat-value">{{ stats.total_indexers | default: "0" }}</span>
                <span class="servarr-stat-label">Indexers</span>
              </div>
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_check }}</span>
                <span class="servarr-stat-value">{{ stats.enabled_indexers | default: "0" }}</span>
                <span class="servarr-stat-label">Enabled</span>
              </div>
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_download }}</span>
                <span class="servarr-stat-value">{{ stats.total_grabs | default: "0" }}</span>
                <span class="servarr-stat-label">Grabs</span>
              </div>
              <div class="servarr-stat-box">
                <span class="servarr-stat-icon">{{ icon_search }}</span>
                <span class="servarr-stat-value">{{ stats.total_queries | default: "0" }}</span>
                <span class="servarr-stat-label">Queries</span>
              </div>

            {% else %}
              <div class="servarr-empty" style="grid-column: span 2;">No stats</div>
          {% endcase %}
        </div>
      </div>
    </div>
  </div>
  {% endif %}

</div>
{% endcase %}

<div class="title_bar">
  <span class="title">
    <span class="app-logo">
      {% case app_type %}
        {% when "sonarr" %}{{ logo_sonarr }}
        {% when "radarr" %}{{ logo_radarr }}
        {% when "lidarr" %}{{ logo_lidarr }}
        {% when "readarr" %}{{ logo_readarr }}
        {% when "prowlarr" %}{{ logo_prowlarr }}
      {% endcase %}
    </span>
    {{ app_name | default: "Servarr" }}
  </span>
  <span class="instance">{{ last_updated | date: "%s" | plus: trmnl.user.utc_offset | date: "%H:%M" }}</span>
</div>
